Warning: wav2capt.txt not found. Creating image-text pairs only.
Loaded 30000 tri-modal samples for train split
Warning: wav2capt.txt not found. Creating image-text pairs only.
Loaded 5000 tri-modal samples for val split
Loading E5 text encoder...
Loading CLIP vision encoder...
Initializing audio CNN encoder...
Creating UpAdapters...
Building modality interfaces...
Creating ThinkingCore...
Assembling MultimodalBrain...
Moving model to cuda...
/home/alex/Documents/DeepLearning2/train_multimodal_brain_flickr8k.py:413: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  self.scaler = torch.cuda.amp.GradScaler(enabled=use_amp)
Train samples: 30000
Val samples:   5000
Device: cuda
Precision: fp16
Batch size: 4
Learning rate: 0.0002
It looks like you are trying to rescale already rescaled images. If the input images have pixel values between 0 and 1, set `do_rescale=False` to avoid rescaling them again.
/home/alex/Documents/DeepLearning2/train_multimodal_brain_flickr8k.py:465: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=self.scaler.is_enabled()):
/home/alex/Documents/DeepLearning2/train_multimodal_brain_flickr8k.py:510: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=self.scaler.is_enabled()):
[epoch 0] val_loss = 5.5423
[epoch 0] new best val 5.5423 -> saved checkpoints_brain_v2/best_brain_v2.pt
[epoch 1] val_loss = 5.0868
[epoch 1] new best val 5.0868 -> saved checkpoints_brain_v2/best_brain_v2.pt
Training complete.
Best val loss: 5.0868
Best model saved under: checkpoints_brain_v2
